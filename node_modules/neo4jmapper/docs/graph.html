<!DOCTYPE html>

<html>
<head>
  <title>graph.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="conditionalparameters.html">
                conditionalparameters.js
              </a>
            
              
              <a class="source" href="cypherquery.html">
                cypherquery.js
              </a>
            
              
              <a class="source" href="graph.html">
                graph.js
              </a>
            
              
              <a class="source" href="helpers.html">
                helpers.js
              </a>
            
              
              <a class="source" href="index.html">
                index.js
              </a>
            
              
              <a class="source" href="neo4jrestful.html">
                neo4jrestful.js
              </a>
            
              
              <a class="source" href="node.html">
                node.js
              </a>
            
              
              <a class="source" href="path.html">
                path.js
              </a>
            
              
              <a class="source" href="relationship.html">
                relationship.js
              </a>
            
              
              <a class="source" href="transaction.html">
                transaction.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>graph.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/**
 * **The Graph** respresents the cypher-query-api of the neo4j database
 * You can perform basic actions and queries directly on the graph
 * ###[Query Structure](http://docs.neo4j.org/refcard/2.0/)
 * Read Query Structure:
 * [START]
 * [MATCH]
 * [WHERE]
 * [WITH [ORDER BY] [SKIP] [LIMIT]]
 * RETURN [ORDER BY] [SKIP] [LIMIT]
 *
 * Write-Only Query Structure:
 * (CREATE [UNIQUE] | MERGE)*
 * [SET|DELETE|FOREACH]*
 * [RETURN [ORDER BY] [SKIP] [LIMIT]]
 *
 * Read-Write Query Structure:
 * [START]
 * [MATCH]
 * [WHERE]
 * [WITH [ORDER BY] [SKIP] [LIMIT]]
 * [CREATE [UNIQUE]|MERGE]*
 * [SET|DELETE|FOREACH]*
 * [RETURN [ORDER BY] [SKIP] [LIMIT]]
 *
 * @todo: maybe check of valid query structure?!
 */</span>


<span class="comment">/**
 * Initialize the Graph object with a neo4jrestful client
 *
 * @param {object} neo4jrestful object
 * @return {object} Graph object
 */</span>
<span class="keyword">var</span> __initGraph__ = <span class="keyword">function</span>(neo4jrestful) {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Requirements (for browser and nodejs):
  <em> neo4jmapper helpers
  </em> underscorejs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">if</span> (<span class="keyword">typeof</span> window === <span class="string">'object'</span>) {
    <span class="keyword">var</span> helpers               = window.Neo4jMapper.helpers;
    <span class="keyword">var</span> _                     = window._;
    <span class="keyword">var</span> CypherQuery           = window.Neo4jMapper.CypherQuery;
    <span class="keyword">var</span> ConditionalParameters = window.Neo4jMapper.ConditionalParameters;
  } <span class="keyword">else</span> {
    <span class="keyword">var</span> helpers               = require(<span class="string">'./helpers'</span>);
    <span class="keyword">var</span> _                     = require(<span class="string">'underscore'</span>);
    <span class="keyword">var</span> CypherQuery           = require(<span class="string">'./cypherquery'</span>);
    <span class="keyword">var</span> ConditionalParameters = require(<span class="string">'./conditionalparameters'</span>)
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Ensure that we have a Neo4jRestful client we can work with</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">if</span> ((<span class="keyword">typeof</span> neo4jrestful !== <span class="string">'undefined'</span>) &amp;&amp; (helpers.constructorNameOfFunction(neo4jrestful) !== <span class="string">'Neo4jRestful'</span>))
    <span class="keyword">throw</span> Error(<span class="string">'You have to use an Neo4jRestful object as argument'</span>)

  <span class="comment">/**
   * Constructor of Graph
   * @constructor
   * @param {string} url
   */</span>
  <span class="keyword">var</span> Graph = <span class="function"><span class="keyword">function</span> <span class="title">Graph</span><span class="params">(url)</span> {</span>
    <span class="keyword">if</span> (url) {
      <span class="keyword">this</span>.neo4jrestful = <span class="keyword">new</span> neo4jrestful.constructor(url);
    }
    <span class="keyword">this</span>.resetQuery();
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  Graph.prototype.neo4jrestful                  = neo4jrestful;
  Graph.prototype._query_history_               = <span class="literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>see graph.resetQuery() for initialization</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Graph.prototype.cypher                        = <span class="literal">null</span>;
  Graph.prototype._queryString_                 = <span class="string">''</span>;           <span class="comment">// stores a query string temporarily</span>
  Graph.prototype._loadOnResult_                = <span class="string">'node|relationship|path'</span>;
  Graph.prototype._resortResults_               = <span class="literal">true</span>;         <span class="comment">// see in graph.query() -&gt; _increaseDone()</span>
  Graph.prototype._nativeResults_               = <span class="literal">false</span>;        <span class="comment">// it's not implemented, all results are processed so far</span>

  Graph.prototype.info                          = <span class="literal">null</span>;         <span class="comment">// contains the info response of the neo4j database</span>

  Graph.prototype._response_                    = <span class="literal">null</span>;         <span class="comment">// contains the last response object</span>
  Graph.prototype._columns_                     = <span class="literal">null</span>;         <span class="comment">// contains `columns` of { columns: [ … ], data: [ … ] }</span>

  <span class="comment">/**
    * The following argument combinations are accepted:
    * * query, parameters, cb
    * * parameters, cb
    * * query, cb
    * * cb
    *
    * Example:
    *
    *     `Graph.new().exec('START n=node({id}) RETURN n;', { id: 123 }, cb);`
    *
    *
    * @param  {string|object|function} [query]
    * @param  {object|function} [parameters]
    * @param  {Function} cb (optional, but needed to trigger query execution finally)
    */</span>
  Graph.prototype.exec = <span class="keyword">function</span>(query, parameters, cb) {
    <span class="keyword">if</span> (<span class="keyword">typeof</span> query === <span class="string">'function'</span>) {
      cb = query;
      query = <span class="literal">undefined</span>;
      parameters = <span class="literal">undefined</span>;
    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> parameters === <span class="string">'function'</span>) {
      cb = parameters;
      <span class="keyword">if</span> (<span class="keyword">typeof</span> query === <span class="string">'object'</span>) {
        parameters = query;
        query = <span class="literal">undefined</span>;
      }
    }
    <span class="keyword">if</span> (<span class="keyword">typeof</span> query === <span class="string">'object'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>query may be parameters</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      parameters = query;
      query = <span class="literal">undefined</span>;
    }
    <span class="keyword">if</span> ((<span class="keyword">typeof</span> parameters === <span class="string">'object'</span>) &amp;&amp; (parameters !== <span class="literal">null</span>)) {
      <span class="keyword">this</span>.addParameters(parameters);
    }
    <span class="keyword">if</span> (<span class="keyword">typeof</span> cb === <span class="string">'function'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>args: queryString, parameters (are added above), cb, options (no options are used here)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.query(query, {}, cb, {});
    }
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Executes a (cypher)-query-string directly in neo4j
   *
   * Example:
   *
   *    `Graph.query('START n=node(123) RETURN n;', cb);`
   *
   * @param  {string} cypherQuery
   * @param  {object} [parameters]
   * @param  {Function} cb
   * @param  {object} [options] will be passed to `neo4jrestful.query`
   */</span>
  Graph.prototype.query = <span class="keyword">function</span>(cypherQuery, parameters, cb, options) {
    <span class="keyword">var</span> self = <span class="keyword">this</span>;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> cypherQuery !== <span class="string">'string'</span>) {
      cypherQuery = <span class="keyword">this</span>.toCypherQuery();
    }
    <span class="keyword">if</span> (<span class="keyword">typeof</span> parameters === <span class="string">'function'</span>) {
      cb = parameters;
      options = {};
      parameters = {};
    }
    <span class="keyword">if</span> ((<span class="keyword">typeof</span> options !== <span class="string">'object'</span>)&amp;&amp;(options !== <span class="literal">null</span>)) {
      options = {};
    }

    <span class="keyword">if</span> (!parameters)
      parameters = {};
    <span class="keyword">if</span> (Object.keys(parameters).length &gt; <span class="number">0</span>) {
      <span class="keyword">this</span>.addParameters(parameters);
    }

    options.params = (<span class="keyword">typeof</span> <span class="keyword">this</span>.cypher.useParameters === <span class="string">'boolean'</span>) ? <span class="keyword">this</span>.parameters() : {};
    options.context = self;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>we expect a cb in most cases and perfom the query immediately</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (<span class="keyword">typeof</span> cb === <span class="string">'function'</span>) {
      <span class="keyword">this</span>.neo4jrestful.query(cypherQuery, options, <span class="keyword">function</span>(err, res, debug) {
        self._processResult(err, res, debug, options, <span class="keyword">function</span>(err, res, debug) {</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Is used by Node on performing an &quot;update&quot; via a cypher query
The result length is 1, so we remove the array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="keyword">if</span> ((res)&amp;&amp;(res.length===<span class="number">1</span>)&amp;&amp;(options.cypher)) {
            <span class="keyword">if</span> ((options.cypher.limit === <span class="number">1</span>) || (options.cypher._update_) || (<span class="keyword">typeof</span> res[<span class="number">0</span>] !== <span class="string">'object'</span>)) {
              res = res[<span class="number">0</span>];
            }
          }
          cb(err, res, debug);
        });
      });
    } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>otherwise we store the query string and expect it will be executed with <code>.exec(cb)</code> or <code>.stream(cb)</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>._queryString_ = cypherQuery;
    }

    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Returns the number of column wich contains the labels
   * @private
   * @param  {array} columns
   * @return {number} of column
   */</span>
  Graph.prototype.__indexOfLabelColumn = <span class="keyword">function</span>(columns) {
    <span class="keyword">var</span> labelColumns = <span class="keyword">this</span>.__indexOfLabelColumns(columns);
    <span class="keyword">var</span> keys = Object.keys(labelColumns);
    <span class="keyword">return</span> (keys.length === <span class="number">1</span>) ? keys[<span class="number">0</span>] : -<span class="number">1</span>;
  }

  <span class="comment">/**
   * Returns the numbers of column wich contain labels
   * @private
   * @param  {array} columns
   * @return {array} indexes
   */</span>
  Graph.prototype.__indexOfLabelColumns = <span class="keyword">function</span>(columns) {
    <span class="keyword">var</span> labelColumns = {};
    <span class="keyword">if</span> (<span class="keyword">typeof</span> columns === <span class="string">'undefined'</span>)
      columns = <span class="keyword">this</span>._columns_;
    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; columns.length; i++) {
      <span class="keyword">if</span> (<span class="regexp">/^labels\([a-zA-Z]+\)$/</span>.test(columns[i]))
        labelColumns[i] = columns[i];
    }
    <span class="keyword">return</span> labelColumns;
  }

  <span class="comment">/**
   * Removes label column from array
   * @private
   * @param  {array} array
   * @param  {number} columnIndexOfLabel
   * @return {array} without label column
   */</span>
  Graph.prototype.__removeLabelColumnFromArray = <span class="keyword">function</span>(array, columnIndexOfLabel) {
    <span class="keyword">if</span> (<span class="keyword">typeof</span> columnIndexOfLabel !== <span class="string">'number'</span>)
      columnIndexOfLabel = <span class="keyword">this</span>.__indexOfLabelColumn();
    array.splice(columnIndexOfLabel, <span class="number">1</span>);
    <span class="keyword">return</span> array;
  }

  <span class="comment">/**
   * Removes label column from results
   * @private
   * @param  {array} result
   * @return {array} without label column
   */</span>
  Graph.prototype.__sortOutLabelColumn = <span class="keyword">function</span>(result) {
    <span class="keyword">var</span> nodeLabels = [];
    <span class="keyword">var</span> nodeLabelsColumn = <span class="keyword">this</span>.__indexOfLabelColumn(result.columns);
    <span class="keyword">var</span> self = <span class="keyword">this</span>;
    <span class="keyword">if</span> (nodeLabelsColumn &gt;= <span class="number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>we have a &#39;labels(n)&#39; column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; result.data.length; i++) {
        nodeLabels.push(result.data[i][nodeLabelsColumn]);
        result.data[i] = self.__removeLabelColumnFromArray(result.data[i], nodeLabelsColumn);
      }
      <span class="keyword">this</span>._columns_ = self.__removeLabelColumnFromArray(<span class="keyword">this</span>._columns_, nodeLabelsColumn);
    }
    <span class="keyword">return</span> nodeLabels;
  }

  <span class="comment">/**
   * Processes results array, i.e.
   * * sort out data result
   * * detect objects and instantiate them
   * * applies labels from result set on node object(s)
   * @param  {object}   err
   * @param  {object}   result
   * @param  {object}   debug
   * @param  {object}   options
   * @param  {Function} cb
   */</span>
  Graph.prototype._processResult = <span class="keyword">function</span>(err, result, debug, options, cb) {
    <span class="keyword">var</span> self = options.context;
    self._response_ = self.neo4jrestful._response_;
    self._columns_ = self.neo4jrestful._columns_;
    <span class="keyword">if</span> (err)
      <span class="keyword">return</span> cb(err, result, debug);
    <span class="keyword">var</span> loadNode = <span class="regexp">/node/i</span>.test(self._loadOnResult_);
    <span class="keyword">var</span> loadRelationship = <span class="regexp">/relation/i</span>.test(self._loadOnResult_);
    <span class="keyword">var</span> loadPath = <span class="regexp">/path/i</span>.test(self._loadOnResult_);
    <span class="keyword">var</span> todo = <span class="number">0</span>;
    <span class="keyword">var</span> iterationDone = <span class="literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>if we have the native mode, return results instantly at this point
TODO: to be implemented</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (self._nativeResults_)</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>we turned off all loading hooks and no sorting -&gt; so lets return the native result</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">return</span> cb(err, result, debug);</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>increase the number of done jobs
resort the results if options is activated
and finally invoke the cb if we are done</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> __oneMoreJobDone = <span class="keyword">function</span>() {
      <span class="keyword">if</span> ((todo === <span class="number">0</span>)&amp;&amp;(iterationDone)) {

        <span class="keyword">if</span> (result.data.length === <span class="number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>empty result</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="keyword">return</span> cb(err, <span class="literal">null</span>, debug);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>if is set to true, sort result:
<em> return only the data (columns are attached to graph.<em>columns</em>)
</em> remove array if we only have one column
e.g. { columns: [ &#39;count&#39; ], data: [ { 1 } ] } -&gt; 1</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (self._resortResults_) {
          <span class="keyword">var</span> cleanResult = result.data;</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>remove array, if we have only one column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="keyword">if</span> (self._columns_.length === <span class="number">1</span>) {
            <span class="keyword">for</span> (<span class="keyword">var</span> row=<span class="number">0</span>; row &lt; cleanResult.length; row++) {
              cleanResult[row] = cleanResult[row][<span class="number">0</span>];
            }
          }
          <span class="keyword">if</span> ((self.cypher.limit === <span class="number">1</span>) &amp;&amp; (cleanResult.length === <span class="number">1</span>)) {</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>if we have a limit of 1 we can only get data[0] or null</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            cleanResult = (cleanResult.length === <span class="number">1</span>) ? cleanResult[<span class="number">0</span>] : <span class="literal">null</span>;
          }
          cb(err, cleanResult, debug);
        } <span class="keyword">else</span> {
          cb(err, result, debug);
        }
      } <span class="keyword">else</span> {
        todo--;
      }
    }



    <span class="keyword">if</span> ((!result.data)&amp;&amp;(result.length === <span class="number">1</span>)) {
      <span class="keyword">return</span> cb(err, result[<span class="number">0</span>], debug);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>check for node labels column (is attached by query builder)
copy to a new array and remove column from result to the results cleaner</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> nodeLabelsColumn = <span class="keyword">this</span>.__indexOfLabelColumn(result.columns);
    <span class="keyword">var</span> nodeLabels = (<span class="keyword">this</span>._resortResults_) ? <span class="keyword">this</span>.__sortOutLabelColumn(result) : <span class="literal">null</span>;

    <span class="keyword">var</span> recommendConstructor = options.recommendConstructor;

    <span class="keyword">for</span> (<span class="keyword">var</span> row=<span class="number">0</span>; row &lt; result.data.length; row++) {
      <span class="keyword">for</span> (<span class="keyword">var</span> column=<span class="number">0</span>; column &lt; result.data[row].length; column++) {
        <span class="keyword">var</span> data = result.data[row][column];</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>try to create an instance if we have an object here</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> ((<span class="keyword">typeof</span> data === <span class="string">'object'</span>) &amp;&amp; (data !== <span class="literal">null</span>))
          self.neo4jrestful.createObjectFromResponseData(result.data[row][column], recommendConstructor);</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>result.data[row][column] = object;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> object = result.data[row][column];

        <span class="keyword">if</span> (object) {
          <span class="keyword">if</span> ((object.classification === <span class="string">'Node'</span>) &amp;&amp; (loadNode)) {

            <span class="keyword">if</span> (nodeLabelsColumn &gt;= <span class="number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>if we have labels(n) column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              <span class="keyword">var</span> labels = nodeLabels.shift()
              object = self.neo4jrestful.Node.instantiateNodeAsModel(object, labels, options.recommendConstructor);
              object.__skip_loading_labels__ = <span class="literal">true</span>;
            }
            todo++;
            object.load(__oneMoreJobDone);
          }
          <span class="keyword">else</span> <span class="keyword">if</span> ((object.classification === <span class="string">'Relationship'</span>) &amp;&amp; (loadRelationship)) {
            todo++;
            object.load(__oneMoreJobDone);
          }
          <span class="keyword">else</span> <span class="keyword">if</span> ((object.classification === <span class="string">'Path'</span>) &amp;&amp; (loadPath)) {
            todo++;
            object.load(__oneMoreJobDone);
          }

          result.data[row][column] = object;
        }

      }
    }

    iterationDone = <span class="literal">true</span>;
    __oneMoreJobDone();

    <span class="keyword">return</span> <span class="keyword">this</span>;

  }

  <span class="comment">/**
   * Stream a cypher query
   * @param  {string}   [cypherQuery]
   * @param  {object}   [parameters]
   * @param  {Function} cb
   * @param  {object}   [options]
   */</span>
  Graph.prototype.stream = <span class="keyword">function</span>(cypherQuery, parameters, cb, options) {
    <span class="keyword">var</span> self = <span class="keyword">this</span>;
    <span class="keyword">var</span> Node = Graph.Node;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>check arguments for callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (<span class="keyword">typeof</span> cypherQuery === <span class="string">'function'</span>) {
      cb = cypherQuery;
      cypherQuery = <span class="literal">undefined</span>;
    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> parameters === <span class="string">'function'</span>) {
      cb = parameters;
      parameters = <span class="literal">undefined</span>;
    }
    <span class="keyword">if</span> (<span class="keyword">typeof</span> cypherQuery !== <span class="string">'string'</span>) {
      cypherQuery = <span class="keyword">this</span>.toCypherQuery();
    }
    <span class="keyword">if</span> (parameters) {
      <span class="keyword">this</span>.addParameters(parameters);
    }
    <span class="keyword">if</span> (!options) {
      options = {};
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>get and set option values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> recommendConstructor = (options) ? options.recommendConstructor || Node : Node;
    options.params = (<span class="keyword">typeof</span> <span class="keyword">this</span>.cypher.useParameters === <span class="string">'boolean'</span>) ? <span class="keyword">this</span>.parameters() : {};
    parameters = <span class="keyword">this</span>.parameters();
    <span class="keyword">var</span> i = <span class="number">0</span>; <span class="comment">// counter is used to prevent changing _columns_ more than once</span>
    <span class="keyword">var</span> indexOfLabelColumn = <span class="literal">null</span>;
    <span class="keyword">this</span>.neo4jrestful.stream(cypherQuery, options, <span class="keyword">function</span>(data, response, debug) {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>neo4jrestful already created an object, but not with a recommend constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      self._columns_ = response._columns_;
      <span class="keyword">if</span> ((self._resortResults_)&amp;&amp;(i === <span class="number">0</span>)) {
        indexOfLabelColumn = self.__indexOfLabelColumn(self._columns_);
        <span class="keyword">if</span> (indexOfLabelColumn &gt;= <span class="number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>remove [ &#39;n&#39;, &#39;labels(n)&#39; ] labels(n) column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          self._columns_ = self.__removeLabelColumnFromArray(self._columns_, indexOfLabelColumn);
        }
      }
      <span class="keyword">if</span> ((data) &amp;&amp; (<span class="keyword">typeof</span> data === <span class="string">'object'</span>)) {
        <span class="keyword">if</span> (data.constructor === Array) {
          <span class="keyword">var</span> labels = <span class="literal">null</span>;
          <span class="keyword">if</span> ((self._resortResults_) &amp;&amp; (indexOfLabelColumn &gt;= <span class="number">0</span>)) {
            labels = data[indexOfLabelColumn];
            data = self.__removeLabelColumnFromArray(data, indexOfLabelColumn);
            <span class="keyword">if</span> (data.length === <span class="number">1</span>)
              data = data[<span class="number">0</span>];
          }
          <span class="keyword">for</span> (<span class="keyword">var</span> column = <span class="number">0</span>; column &lt; data.length; column++) {
            <span class="keyword">if</span> ((data[column]) &amp;&amp; (data[column]._response_)) {
              data[column] = self.neo4jrestful.createObjectFromResponseData(data[column]._response_, recommendConstructor);
              data[column] = self.neo4jrestful.Node.instantiateNodeAsModel(data[column], labels);
            }

          }
        }
      }
      self._response_ = response;
      <span class="keyword">if</span> ((data) &amp;&amp; (data._response_)) {
        data = self.neo4jrestful.createObjectFromResponseData(data._response_, recommendConstructor);</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>data = self.neo4jrestful.Node.instantiateNodeAsModel(data, labels);</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      }
      i++;
      <span class="keyword">return</span> cb(data, self, debug);
    });
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Shortcut for `graph.stream`
   * @see  Graph.prototype.stream
   */</span>
  Graph.prototype.each = Graph.prototype.stream;

  <span class="comment">/**
   * Set cypher parameters (and removes previous ones if exists)
   * @param  {object} parameters
   */</span>
  Graph.prototype.setParameters = <span class="keyword">function</span>(parameters) {
    <span class="keyword">if</span> ((<span class="keyword">typeof</span> parameters !== <span class="string">'object'</span>) || (parameters === <span class="literal">null</span>))
      <span class="keyword">throw</span> Error(<span class="string">'parameter(s) as argument must be an object, e.g. { key: "value" }'</span>)
    <span class="keyword">if</span> (<span class="keyword">this</span>.cypher.useParameters === <span class="literal">null</span>)
      <span class="keyword">this</span>.cypher.useParameters = <span class="literal">true</span>;
    <span class="keyword">this</span>.cypher.parameters = parameters;
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Get cypher parameters
   * @return  {object} parameters
   */</span>
  Graph.prototype.parameters = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>.cypher.parameters || {};
  }

  <span class="comment">/**
   * Add cypher Parameters
   * @param  {object} parameters
   */</span>
  Graph.prototype.addParameters = <span class="keyword">function</span>(parameters) {
    <span class="keyword">this</span>.cypher.addParameters(parameters);
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Add cypher Parameter
   * @param  {object} parameter
   */</span>
  Graph.prototype.addParameter = <span class="keyword">function</span>(parameter) {
    <span class="keyword">return</span> <span class="keyword">this</span>.addParameters(parameter);
  }

  <span class="comment">/**
   * Deletes *all* nodes and *all* relationships
   * @param  {Function} cb
   */</span>
  Graph.prototype.wipeDatabase = <span class="keyword">function</span>(cb) {
    <span class="keyword">var</span> query = <span class="string">"START n=node(*) MATCH n-[r?]-() DELETE n, r;"</span>;
    <span class="keyword">return</span> <span class="keyword">this</span>.query(query, cb);
  }

  <span class="comment">/**
   * Counts all objects of a specific type
   * @param  {String}   (all|node|relationship|[nr]:Movie)
   * @param  {Function} cb
   */</span>
  Graph.prototype.countAllOfType = <span class="keyword">function</span>(type, cb) {
    <span class="keyword">var</span> query = <span class="string">''</span>;
    <span class="keyword">if</span>      (<span class="regexp">/^n(ode)*$/i</span>.test(type))
      query = <span class="string">"START n=node(*) RETURN count(n);"</span>
    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/^r(elationship)*$/i</span>.test(type))
      query = <span class="string">"START r=relationship(*) RETURN count(r);"</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/^[nr]\:.+/</span>.test(type))</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>count labels</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      query = <span class="string">"MATCH "</span>+type+<span class="string">" RETURN "</span>+type[<span class="number">0</span>]+<span class="string">";"</span>;
    <span class="keyword">else</span>
      query = <span class="string">"START n=node(*) OPTIONAL MATCH n-[r]-() RETURN count(n), count(r);"</span>;
    <span class="keyword">return</span> Graph.query(query, <span class="keyword">function</span>(err,data){
      <span class="keyword">if</span> ((data)&amp;&amp;(data.data)) {
        <span class="keyword">var</span> count = data.data[<span class="number">0</span>][<span class="number">0</span>];
        <span class="keyword">if</span> (<span class="keyword">typeof</span> data.data[<span class="number">0</span>][<span class="number">1</span>] !== <span class="string">'undefined'</span>)
          count += data.data[<span class="number">0</span>][<span class="number">1</span>];
        <span class="keyword">return</span> cb(err, count);
      }
      cb(err,data);
    });
  }

  <span class="comment">/**
   * Counts all relationships
   * @param  {Function} cb
   */</span>
  Graph.prototype.countRelationships = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.countAllOfType(<span class="string">'relationship'</span>, cb);
  }

  <span class="comment">/**
   * Alias for countRelationships()
   * @see Graph.countRelationships()
   * @param  {Function} cb
   */</span>
  Graph.prototype.countRelations = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.countRelationships(cb);
  }

  <span class="comment">/**
   * Counts all nodes
   * @param  {Function} cb
   */</span>
  Graph.prototype.countNodes = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.countAllOfType(<span class="string">'node'</span>, cb);
  }

  <span class="comment">/**
   * Counts all relationships and nodes
   * @param  {Function} cb
   */</span>
  Graph.prototype.countAll = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.countAllOfType(<span class="string">'all'</span>, cb);
  }

  <span class="comment">/**
   * Queries information of the database and stores it on `this.info`
   * @param  {Function} cb
   */</span>
  Graph.prototype.about = <span class="keyword">function</span>(cb) {
    <span class="keyword">var</span> self = <span class="keyword">this</span>;
    <span class="keyword">if</span> (<span class="keyword">this</span>.info)
      <span class="keyword">return</span> cb(<span class="literal">null</span>,info);
    <span class="keyword">else</span>
      <span class="keyword">return</span> <span class="keyword">this</span>.neo4jrestful.get(<span class="string">'/'</span>+<span class="keyword">this</span>.neo4jrestful.urlOptions.endpoint, <span class="keyword">function</span>(err, info){
        <span class="keyword">if</span> (info) {
          self.info = info
        }
        <span class="keyword">if</span> (<span class="keyword">typeof</span> cb === <span class="string">'function'</span>)
          cb(err,info);
      });
  }

  <span class="comment">/**
   * Resets the query history
   */</span>
  Graph.prototype.resetQuery = <span class="keyword">function</span>() {
    <span class="keyword">this</span>._query_history_ = [];
    <span class="keyword">this</span>._queryString_ = <span class="string">''</span>;
    <span class="keyword">this</span>.cypher = <span class="keyword">new</span> CypherQuery();
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   *  Startpoint to begin query chaining
   *
   *  Example:
   *    `Graph.start().where( …`
   *
   * @param  {string}   start
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.start = <span class="keyword">function</span>(start, parameters, cb) {
    <span class="keyword">this</span>.resetQuery();
    <span class="keyword">if</span> (<span class="keyword">typeof</span> start === <span class="string">'function'</span>) {
      cb = start;
      start = <span class="literal">null</span>;
    }
    <span class="keyword">if</span> (start)
      <span class="keyword">this</span>._query_history_.push({ START: start });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `MATCH …`
   * @param  {object|string|array}   match
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   * @param  {object}   [options]
   */</span>
  Graph.prototype.match = <span class="keyword">function</span>(match, parameters, cb, options) {
    <span class="keyword">var</span> self = <span class="keyword">this</span>;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> options !== <span class="string">'object'</span>)
      options = {};
    <span class="keyword">var</span> matchString = <span class="string">''</span>;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> match === <span class="string">'object'</span>) {
      <span class="keyword">if</span> (match.length) {
        match.forEach(<span class="keyword">function</span>(item){
          <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">'object'</span>) {
            matchString += self._addObjectLiteralForStatement(item);
          } <span class="keyword">else</span> {
            matchString += String(item);
          }
        });
      } <span class="keyword">else</span> {
        matchString = self._addObjectLiteralForStatement(match);
      }
    } <span class="keyword">else</span> {
      matchString = match;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>do we have &quot;ON MATCH&quot;, &quot;OPTIONAL MATCH&quot; or &quot;MATCH&quot; ?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (!options.<span class="keyword">switch</span>)
      <span class="keyword">this</span>._query_history_.push({ MATCH: matchString });
    <span class="keyword">else</span> <span class="keyword">if</span> (options.<span class="keyword">switch</span> === <span class="string">'ON MATCH'</span>)
      <span class="keyword">this</span>._query_history_.push({ ON_MATCH: matchString });
    <span class="keyword">else</span> <span class="keyword">if</span> (options.<span class="keyword">switch</span> === <span class="string">'OPTIONAL MATCH'</span>)
      <span class="keyword">this</span>._query_history_.push({ OPTIONAL_MATCH: matchString });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `ON MATCH …`
   * @param  {string|object|array}   onMatch
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.onMatch = <span class="keyword">function</span>(onMatch, parameters, cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.match(onMatch, parameters, cb, { <span class="keyword">switch</span>: <span class="string">'ON MATCH'</span> });
  }

  <span class="comment">/**
   * `OPTIONAL MATCH …`
   * @param  {string|object|array}   onMatch
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.optionalMatch = <span class="keyword">function</span>(optionalMatch, parameters, cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.match(optionalMatch, parameters, cb, { <span class="keyword">switch</span>: <span class="string">'OPTIONAL MATCH'</span> });
  }

  <span class="comment">/**
   * `WITH …`
   * @param  {string}   withStatement
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.<span class="keyword">with</span> = <span class="keyword">function</span>(withStatement, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ WITH: withStatement });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `SKIP …`
   * @param  {number}   skip
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.skip = <span class="keyword">function</span>(skip, parameters, cb) {
    skip = parseInt(skip);
    <span class="keyword">if</span> (skip === <span class="literal">NaN</span>)
      <span class="keyword">throw</span> Error(<span class="string">'SKIP must be an integer'</span>);
    <span class="keyword">this</span>._query_history_.push({ SKIP: skip });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `LIMIT …`
   * @param  {number}   limit
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.limit = <span class="keyword">function</span>(limit, parameters, cb) {
    limit = parseInt(limit);
    <span class="keyword">if</span> (limit === <span class="literal">NaN</span>)
      <span class="keyword">throw</span> Error(<span class="string">'LIMIT must be an integer'</span>);
    <span class="keyword">this</span>._query_history_.push({ LIMIT: limit });
    <span class="keyword">this</span>.cypher.limit = limit; <span class="comment">// TODO: implement: if limit 1 only return { r } or null instead if [ { r } ]</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `MERGE …`
   * @param  {string}   merge
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.merge = <span class="keyword">function</span>(merge, parameters, cb) {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>TODO: values to parameter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">this</span>._query_history_.push({ MERGE: merge });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * Pure string as statement segment
   * @param  {string}   statement
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.custom = <span class="keyword">function</span>(statement, parameters, cb) {
    <span class="keyword">if</span> ((<span class="keyword">typeof</span> statement === <span class="string">'object'</span>) &amp;&amp; (<span class="keyword">typeof</span> statement.toQuery === <span class="string">'function'</span>)) {
      <span class="keyword">this</span>._query_history_.push(statement.toQuery().toString());
    } <span class="keyword">else</span> {
      <span class="keyword">this</span>._query_history_.push(statement);
    }
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `SET …`
   * @param  {string|object}   set
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.set = <span class="keyword">function</span>(set, parameters, cb) {
    <span class="keyword">var</span> setString = <span class="string">''</span>;
    <span class="keyword">var</span> data = <span class="literal">null</span>;
    <span class="keyword">if</span> ((<span class="keyword">typeof</span> set === <span class="string">'object'</span>)&amp;&amp;(set !== <span class="literal">null</span>)) {
      <span class="keyword">if</span> (set.constructor !== Array) {
        data = set;
        set = [];
        <span class="keyword">if</span> (<span class="keyword">this</span>.cypher.useParameters) {
          set = <span class="keyword">this</span>._addKeyValuesToParameters(data, <span class="string">' = '</span>);
        } <span class="keyword">else</span> {
          <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) {
            <span class="keyword">var</span> value = data[key];
            set.push(helpers.escapeProperty(key)+<span class="string">' = '</span>+helpers.valueToStringForCypherQuery(value, <span class="string">"'"</span>));
          }
        }
      }
      setString += set.join(<span class="string">', '</span>);
    } <span class="keyword">else</span> {
      setString += set;
    }
    <span class="keyword">this</span>._query_history_.push({ SET: setString });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `SET n = …`, sets explicit to a set of values
   *
   * Example:
   *  `{ n: { name: 'Steve' } }`
   *  ~&gt; SET n = { `name`: 'Steve' }
   *
   * @param  {object}   setWith value set
   * @param  {[type]}   parameters
   * @param  {Function} cb
   */</span>
  Graph.prototype.setWith = <span class="keyword">function</span>(setWith, parameters, cb) {
    <span class="keyword">var</span> setString = <span class="string">''</span>;
    setString += Object.keys(setWith)[<span class="number">0</span>]+<span class="string">' = '</span>;
    <span class="keyword">if</span> (<span class="keyword">this</span>.cypher.useParameters) {
      setString += <span class="keyword">this</span>._addObjectLiteralToParameters(setWith[Object.keys(setWith)[<span class="number">0</span>]]);
    } <span class="keyword">else</span> {
      setString += helpers.serializeObjectForCypher(setWith[Object.keys(setWith)[<span class="number">0</span>]]);
    }
    <span class="keyword">this</span>._query_history_.push({ SET: setString });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `CREATE …`
   * @param  {string|object}   create
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   * @param  {[type]}   [options]
   */</span>
  Graph.prototype.create = <span class="keyword">function</span>(create, parameters, cb, options) {
    <span class="keyword">var</span> self = <span class="keyword">this</span>;
    <span class="keyword">var</span> creates = [];
    <span class="keyword">if</span> (<span class="keyword">typeof</span> options !== <span class="string">'object'</span>)
      options = {};
    options = _.defaults(options, {
      action: <span class="string">'CREATE'</span>
    });
    <span class="keyword">if</span> (<span class="keyword">typeof</span> create === <span class="string">'object'</span>) {
      creates.push(<span class="string">'( '</span>);
      <span class="keyword">if</span> (create.length) {
        create.forEach(<span class="keyword">function</span>(item){
          <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">'object'</span>) {
            creates.push(self._addObjectLiteralForStatement(item));
          } <span class="keyword">else</span> {
            creates.push(String(item));
          }
        });
      } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>we have a object literal</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> parts = [];

        <span class="keyword">for</span> (<span class="keyword">var</span> part <span class="keyword">in</span> create) {

          <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> create[part]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>on create, only add values beside <code>null</code> and <code>undefined</code>, otherwise neo4j will throw an exception</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">if</span> ((create[part][attr] === <span class="literal">undefined</span>)||(create[part][attr] === <span class="literal">null</span>)) {
              <span class="keyword">delete</span> create[part][attr];
            }
          }
          parts.push(part + <span class="string">' '</span> + self._addObjectLiteralForStatement(create[part]));
        }
        creates.push(parts.join(<span class="string">', '</span>));
      }
      creates.push(<span class="string">' )'</span>);
    } <span class="keyword">else</span> {
      creates = [ create ];
    }
    <span class="keyword">var</span> statementSegment = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>{ CREATE:  creates.join(&#39; &#39;) } for instance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    statementSegment[options.action] = creates.join(<span class="string">' '</span>);
    <span class="keyword">this</span>._query_history_.push(statementSegment);
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `ON CREATE …`
   * @see Graph.prototype.create
   */</span>
  Graph.prototype.onCreate = <span class="keyword">function</span>(onCreate, parameters, cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.create(onCreate, parameters, cb, { action: <span class="string">'ON_CREATE'</span> });
  }

  <span class="comment">/**
   * `CREATE UNIQUE …`
   * @see Graph.prototype.create
   */</span>
  Graph.prototype.createUnique = <span class="keyword">function</span>(createUnique, parameters, cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.create(createUnique, parameters, cb, { action: <span class="string">'CREATE_UNIQUE'</span> });
  }

  <span class="comment">/**
   * `CREATE INDEX ON …`
   * @see Graph.prototype.create
   */</span>
  Graph.prototype.createIndexOn = <span class="keyword">function</span>(createIndexOn, parameters, cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.create(createIndexOn, parameters, cb, { action: <span class="string">'CREATE_INDEX_ON'</span> });
  }

  <span class="comment">/**
   * `CASE … END`
   * @param  {string}   caseStatement
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.<span class="keyword">case</span> = <span class="keyword">function</span>(caseStatement, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ CASE: caseStatement.replace(<span class="regexp">/END\s*$/i</span>,<span class="string">''</span>) + <span class="string">' END '</span> });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `DROP INDEX ON …`
   * @param  {string}   dropIndexOn
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.dropIndexOn = <span class="keyword">function</span>(dropIndexOn, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ DROP_INDEX_ON: dropIndexOn });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `ORDER BY …`
   * @param  {string|object}   property
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.orderBy = <span class="keyword">function</span>(property, parameters, cb) {
    <span class="keyword">var</span> direction = <span class="string">''</span>
      , s = <span class="string">''</span>;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> property === <span class="string">'object'</span>) {
      <span class="keyword">var</span> key = Object.keys(property)[<span class="number">0</span>];
      cb = direction;
      direction = property[key];
      property = key;
      direction = ( (<span class="keyword">typeof</span> direction === <span class="string">'string'</span>) &amp;&amp; ((<span class="regexp">/^(ASC|DESC)$/</span>).test(direction)) ) ? direction : <span class="string">'ASC'</span>;
      s = property+<span class="string">' '</span>+direction;
    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> property === <span class="string">'string'</span>) {
      s = property;
    }
    <span class="keyword">this</span>._query_history_.push({ ORDER_BY: s });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `WHERE …`
   *
   * Examples:
   *    Graph.start('n=node(1)').where({ $OR : [ { 'n.name?': 'Steve' }, { 'n.name?': 'Jobs' } ] })
   *    Graph.start('n=node(1)').where("n.name? = {name1} OR n.name? = {name2}", { name1: 'Steve', name2: 'Jobs' })
   *
   * @param  {object|string}   where
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.where = <span class="keyword">function</span>(where, parameters, cb) {
    <span class="keyword">if</span> (<span class="keyword">typeof</span> where === <span class="string">'string'</span>) {
      <span class="keyword">this</span>._query_history_.push({ WHERE: where });
      <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
    }
    <span class="keyword">if</span> (<span class="keyword">this</span>.cypher.useParameters === <span class="literal">null</span>)
      <span class="keyword">this</span>.cypher.useParameters = <span class="literal">true</span>;
    <span class="keyword">if</span> (!_.isArray(where))
      where = [ where ];
    <span class="keyword">var</span> options = { valuesToParameters: <span class="keyword">this</span>.cypher.useParameters, parametersStartCountAt: Object.keys(<span class="keyword">this</span>.cypher.parameters || {}).length };
    <span class="keyword">var</span> condition = <span class="keyword">new</span> ConditionalParameters(where, options);
    <span class="keyword">var</span> whereCondition = condition.toString().replace(<span class="regexp">/^\(\s(.+)\)$/</span>, <span class="string">'$1'</span>);

    <span class="keyword">this</span>._query_history_.push({ WHERE: whereCondition });
    <span class="keyword">if</span> (<span class="keyword">this</span>.cypher.useParameters)
      <span class="keyword">this</span>.addParameters(condition.parameters);
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `RETURN …`
   * @param  {String}   returnStatement
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.<span class="keyword">return</span> = <span class="keyword">function</span>(returnStatement, parameters, cb, distinct) {
    <span class="keyword">var</span> parts = [];
    <span class="keyword">if</span> (returnStatement) {
      <span class="keyword">if</span> (returnStatement.constructor === Array)
        parts = returnStatement;
      <span class="keyword">if</span> ((<span class="keyword">typeof</span> returnStatement === <span class="string">'Object'</span>) &amp;&amp; (Object.keys(returnStatement).length &gt; <span class="number">0</span>))
        Object.keys(returnStatement).forEach(<span class="keyword">function</span>(key) {
          parts.push(key+<span class="string">' AS '</span> + returnStatement[key]);
        });
    }
    <span class="keyword">if</span> (parts.length &gt; <span class="number">0</span>)
      returnStatement = parts.join(<span class="string">', '</span>);
    <span class="keyword">if</span> (distinct === <span class="literal">true</span>)
      <span class="keyword">this</span>._query_history_.push({ RETURN_DISTINCT: returnStatement });
    <span class="keyword">else</span>
      <span class="keyword">this</span>._query_history_.push({ RETURN: returnStatement });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `RETURN DISTINCT …`
   * @param  {[type]}   returnStatement
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.returnDistinct = <span class="keyword">function</span>(returnStatement, parameters, cb) {
    <span class="keyword">return</span> <span class="keyword">this</span>.<span class="keyword">return</span>(returnStatement, parameters, cb, <span class="literal">true</span>);
  }

  <span class="comment">/**
   * `DELETE …`
   * @param  {string}   deleteStatement
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.<span class="keyword">delete</span> = <span class="keyword">function</span>(deleteStatement, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ DELETE: deleteStatement });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `REMOVE …`
   * @param  {string}   remove
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.remove = <span class="keyword">function</span>(remove, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ REMOVE: remove });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `FOR EACH …`
   * @param  {[type]}   foreach
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.foreach = <span class="keyword">function</span>(foreach, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ FOREACH: foreach });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `UNION …`
   * @param  {[type]}   union
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.union = <span class="keyword">function</span>(union, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ UNION: union });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * `USING …`
   * @param  {[type]}   using
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.using = <span class="keyword">function</span>(using, parameters, cb) {
    <span class="keyword">this</span>._query_history_.push({ USING: using });
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * Cypher-compatible-comment
   * @param  {string}   comment
   * @param  {object}   [parameters]
   * @param  {Function} [cb]
   */</span>
  Graph.prototype.comment = <span class="keyword">function</span>(comment, parameters, cb) {
    <span class="keyword">this</span>.custom(<span class="string">' /* '</span>+comment.replace(<span class="regexp">/^\s*\/\*\s*/</span>,<span class="string">''</span>).replace(<span class="regexp">/\s*\*\/\s*$/</span>,<span class="string">''</span>)+<span class="string">' */ '</span>);
    <span class="keyword">return</span> <span class="keyword">this</span>.exec(parameters, cb);
  }

  <span class="comment">/**
   * Returns cypher query object
   * @return {object} Cypher query object
   */</span>
  Graph.prototype.toQuery = <span class="keyword">function</span>() {
    <span class="keyword">this</span>.cypher.statements = <span class="keyword">this</span>._query_history_;
    <span class="keyword">return</span> <span class="keyword">this</span>.cypher;
  }

  <span class="comment">/**
   * Return query as String
   * @return {string} query
   */</span>
  Graph.prototype.toQueryString = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>.toQuery().toString();
  }

  <span class="comment">/**
   * @see Graph.prototype.toQueryString
   */</span>
  Graph.prototype.toCypherQuery = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>.toQuery().toCypher();
  }


  <span class="comment">/**
   * Enables loading for specific types
   * Define type(s) simply in a string
   *
   * Examples:
   *   'node|relationship|path' or '*' to enable load for all types
   *   'node|relationship' to enable for node + relationships
   *   '' to disable for all (you can also use `disableLoading()` instead)
   *
   * @param  {string} classifications
   */</span>
  Graph.prototype.enableLoading = <span class="keyword">function</span>(classifications) {
    <span class="keyword">if</span> (classifications === <span class="string">'*'</span>)
      classifications = <span class="string">'node|relationship|path'</span>;
    <span class="keyword">this</span>._loadOnResult_ = classifications;
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Disables loading on results (speeds up queries but less convenient)
   */</span>
  Graph.prototype.disableLoading = <span class="keyword">function</span>() {
    <span class="keyword">this</span>._loadOnResult_ = <span class="string">''</span>;
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Sort Results
   * By default we get results like:
   * `{ columns: [ 'node' ], data: [ [ { nodeObject#1 } ], … [ { nodeObject#n} ]] }`
   * To keep it more handy, we return just the data
   * and (if we have only 1 column) instead of [ {node} ] -&gt; {node}
   * If you want to have access to the columns anyway, you can get them on `graph._columns_`
   *
   * @param  {boolean} trueOrFalse
   */</span>
  Graph.prototype.sortResult = <span class="keyword">function</span>(trueOrFalse) {
    <span class="keyword">if</span> (<span class="keyword">typeof</span> trueOrFalse === <span class="string">'undefined'</span>)
      trueOrFalse = <span class="literal">true</span>;
    <span class="keyword">this</span>._resortResults_ = trueOrFalse;
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Enables sorting of result
   */</span>
  Graph.prototype.enableSorting = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>.sortResult(<span class="literal">true</span>);
  }

  <span class="comment">/**
   * Disbales sorting of result
   */</span>
  Graph.prototype.disableSorting = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>.sortResult(<span class="literal">false</span>);
  }

  <span class="comment">/**
   * Enables processing of result
   */</span>
  Graph.prototype.enableProcessing = <span class="keyword">function</span>() {
    <span class="keyword">this</span>.sortResult(<span class="literal">true</span>);
    <span class="keyword">this</span>.enableLoading(<span class="string">'*'</span>);
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Disbales processing of result
   */</span>
  Graph.prototype.disableProcessing = <span class="keyword">function</span>() {
    <span class="keyword">this</span>.sortResult(<span class="literal">false</span>);
    <span class="keyword">this</span>.disableLoading();
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="comment">/**
   * Will be called for logging, can be overriddin with a custom function
   */</span>
  Graph.prototype.log = <span class="keyword">function</span>(){ <span class="comment">/* &gt; /dev/null */</span> };

  <span class="comment">/**
   * Expect s.th. like [ value, value2 ] or [ { key1: value }, { key2: value } ]
   * @private
   * @param  {object|array} parameters
   * @return {object} parameters
   */</span>
  Graph.prototype._addParametersToCypher = <span class="keyword">function</span>(parameters) {
    <span class="keyword">if</span> ( (<span class="keyword">typeof</span> parameters === <span class="string">'object'</span>) &amp;&amp; (parameters) &amp;&amp; (parameters.constructor === Array) ) {
      <span class="keyword">if</span> (!<span class="keyword">this</span>.cypher.hasParameters())
        <span class="keyword">this</span>.cypher.parameters = {};
      <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; parameters.length; i++) {
        <span class="keyword">this</span>._addParameterToCypher(parameters[i]);
      }
    } <span class="keyword">else</span> {
      <span class="keyword">throw</span> Error(<span class="string">'You need to pass parameters as array'</span>);
    }
    <span class="keyword">return</span> <span class="keyword">this</span>.cypher.parameters;
  }

  <span class="comment">/**
   * Expect s.th. like 'value' or { parameterkey: 'value' }
   * @private
   * @param  {string|object} parameter
   * @return {object} parameters
   */</span>
  Graph.prototype._addParameterToCypher = <span class="keyword">function</span>(parameter) {
    <span class="keyword">if</span> (!<span class="keyword">this</span>.cypher.hasParameters())
      <span class="keyword">this</span>.cypher.parameters = {};
    <span class="keyword">if</span> ((<span class="keyword">typeof</span> parameter === <span class="string">'object'</span>)&amp;&amp;(parameter !== <span class="literal">null</span>)) {
      _.extend(<span class="keyword">this</span>.cypher.parameters, parameter);
    } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>we name the parameter with <code>_value#_</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> count = Object.keys(<span class="keyword">this</span>.cypher.parameters).length;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>values with <code>undefined</code> will be replaced with <code>null</code> because neo4j doesn&#39;t process <code>undefined</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.cypher.parameters[<span class="string">'_value'</span>+count+<span class="string">'_'</span>] = (<span class="keyword">typeof</span> parameter === <span class="string">'undefined'</span>) ? <span class="literal">null</span> : parameter;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>return the placeholder</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">return</span> <span class="string">'{_value'</span>+count+<span class="string">'_}'</span>;
    }
    <span class="keyword">return</span> <span class="keyword">this</span>.cypher.parameters;
  }

  <span class="comment">/**
   * Add key value to parameters
   * @private
   * @param  {object} key/value object literal
   * @param  {string} [assignOperator], can be ' = ' or ' : ' for instance
   * @return {array} values
   */</span>
  Graph.prototype._addKeyValuesToParameters = <span class="keyword">function</span>(o, assignOperator) {
    o = helpers.flattenObject(o);
    <span class="keyword">var</span> values = [];
    <span class="keyword">var</span> identifierDelimiter = <span class="string">'`'</span>;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> assignOperator !== <span class="string">'string'</span>)
      assignOperator = <span class="string">' = '</span>;
    <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> o) {
      values.push(helpers.escapeProperty(attr, identifierDelimiter) + assignOperator + <span class="keyword">this</span>._addParameterToCypher(o[attr]));
    }
    <span class="keyword">return</span> values;
  }

  <span class="comment">/**
   * Add object literal to parameters
   * @private
   * @param {object} objectLiteral
   * @return {string} map, e.g. `{ n.`name`: '…', …, n.`phone`: '…'  }`
   */</span>
  Graph.prototype._addObjectLiteralToParameters = <span class="keyword">function</span>(objectLiteral) {
    <span class="keyword">return</span> <span class="string">'{ '</span>+<span class="keyword">this</span>._addKeyValuesToParameters(objectLiteral, <span class="string">' : '</span>).join(<span class="string">', '</span>)+<span class="string">' }'</span>;
  }

  <span class="comment">/**
   * Adds object literal to query.
   * If parameters are used (default), values will be added to parameters and replaced with `{_value%n_}`
   * @private
   * @param  {object} o
   * @return {string} serialized object literal
   */</span>
  Graph.prototype._addObjectLiteralForStatement = <span class="keyword">function</span>(o) {
    <span class="keyword">var</span> s = <span class="string">''</span>;
    <span class="keyword">if</span> (<span class="keyword">this</span>.cypher.useParameters)
      s = <span class="keyword">this</span>._addObjectLiteralToParameters(o);
    <span class="keyword">else</span>
      s = helpers.serializeObjectForCypher(o);
    <span class="keyword">return</span> s;
  }

  <span class="comment">/**
   * # Static methods
   * are aliases to methods on instanced Graph()
   */</span>

  <span class="comment">/**
   * @see Graph.prototype.query
   */</span>
  Graph.query = <span class="keyword">function</span>(cypher, parameters, cb, options) {
    <span class="keyword">return</span> Graph.disableProcessing().query(cypher, parameters, cb, options);
  }

  <span class="comment">/**
   * @see Graph.prototype.stream
   */</span>
  Graph.stream = <span class="keyword">function</span>(cypher, parameters, cb, options) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph.disableProcessing().stream(cypher, parameters, cb, options);
  }

  <span class="comment">/**
   * @see Graph.prototype.wipeDatabase
   */</span>
  Graph.wipeDatabase = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().wipeDatabase(cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.countAllOfType
   */</span>
  Graph.countAllOfType = <span class="keyword">function</span>(type, cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().countAllOfType(type, cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.countRelationships
   */</span>
  Graph.countRelationships = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().countRelationships(cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.countRelations
   */</span>
  Graph.countRelations = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().countRelationships(cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.countNodes
   */</span>
  Graph.countNodes = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().countNodes(cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.countAll
   */</span>
  Graph.countAll = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().countAll(cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.about
   */</span>
  Graph.about = <span class="keyword">function</span>(cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().about(cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.start
   */</span>
  Graph.start = <span class="keyword">function</span>(start, parameters, cb) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph().enableProcessing().start(start, parameters, cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.custom
   */</span>
  Graph.custom = <span class="keyword">function</span>(statement, parameters, cb) {
    <span class="keyword">return</span> Graph.start().custom(statement, parameters, cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.match
   */</span>
  Graph.match = <span class="keyword">function</span>(statement, parameters, cb) {
    <span class="keyword">return</span> Graph.start().match(statement, parameters, cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.where
   */</span>
  Graph.where = <span class="keyword">function</span>(statement, parameters, cb) {
    <span class="keyword">return</span> Graph.start().where(statement, parameters, cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.return
   */</span>
  Graph.<span class="keyword">return</span> = <span class="keyword">function</span>(statement, parameters, cb) {
    <span class="keyword">return</span> Graph.start().<span class="keyword">return</span>(statement, parameters, cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.create
   */</span>
  Graph.create = <span class="keyword">function</span>(statement, parameters, cb) {
    <span class="keyword">return</span> Graph.start().create(statement, parameters, cb);
  }

  <span class="comment">/**
   * @see Graph.prototype.enableLoading
   */</span>
  Graph.enableLoading = <span class="keyword">function</span>(classifications) {
    <span class="keyword">return</span> Graph.start().enableLoading(classifications);
  }

  <span class="comment">/**
   * @see Graph.prototype.disableLoading
   */</span>
  Graph.disableLoading = <span class="keyword">function</span>() {
    <span class="keyword">return</span> Graph.start().disableLoading();
  }

  <span class="comment">/**
   * @see Graph.prototype.disableProcessing
   */</span>
  Graph.disableProcessing = <span class="keyword">function</span>() {
    <span class="keyword">return</span> Graph.start().disableProcessing();
  }

  <span class="comment">/**
   * @see Graph.prototype.enableProcessing
   */</span>
  Graph.enableProcessing = <span class="keyword">function</span>() {
    <span class="keyword">return</span> Graph.start().enableProcessing();
  }

  <span class="comment">/**
   * @see Graph.prototype.enableSorting
   */</span>
  Graph.enableSorting = <span class="keyword">function</span>() {
    <span class="keyword">return</span> Graph.start().enableSorting();
  }

  <span class="comment">/**
   * @see Graph.prototype.disableSorting
   */</span>
  Graph.disableSorting = <span class="keyword">function</span>() {
    <span class="keyword">return</span> Graph.start().disableSorting();
  }

  <span class="comment">/**
   * Returns a new neo4jrestful client
   * Can be used for direct requests on neo4j for instance
   * @return {object} neo4jrestful
   */</span>
  Graph.request = <span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>creates a new neo4jrestful client</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">return</span> neo4jrestful.singleton();
  }

  <span class="comment">/**
   * Instanciate a new Graph object, same as `new Graph()
   * @see Graph
   */</span>
  Graph.<span class="keyword">new</span> = <span class="keyword">function</span>(url) {
    <span class="keyword">return</span> <span class="keyword">new</span> Graph(url);
  }

  <span class="keyword">return</span> neo4jrestful.Graph = Graph;
}

<span class="keyword">if</span> (<span class="keyword">typeof</span> window !== <span class="string">'object'</span>) {
  module.exports = exports = {
    init: __initGraph__
  };
} <span class="keyword">else</span> {
  window.Neo4jMapper.initGraph = __initGraph__;
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
